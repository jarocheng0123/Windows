import"./modulepreload-polyfill-B5Qt9EMX.js";import"./main-D83nNWqK.js";var c="1998-01-01 00:00:00",h="2035-01-01 00:00:00",r=[c,h];function v(){var a=window.parent.location.href,n=new URL(a),t=n.pathname,o=t.split("/"),e=o[o.length-1];return e}var s=v();function d(a){fetch("http://127.0.0.1:21314/month_count",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wxid:s,time_range:a})}).then(t=>t.json()).then(t=>{var o=echarts.init(document.getElementById("echarts-month_count")),e=t.chart_data;e=JSON.parse(e),e.toolbox.show=!1,o.setOption(e)})}function m(a){fetch("http://127.0.0.1:21314/hour_count",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wxid:s,time_range:a})}).then(t=>t.json()).then(t=>{var o=echarts.init(document.getElementById("echarts-hours")),e=t.chart_data;e=JSON.parse(e),e.toolbox.show=!1,o.setOption(e)})}function u(a){fetch("http://127.0.0.1:21314/wordcloud",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wxid:s,time_range:a})}).then(t=>t.json()).then(t=>{var o=echarts.init(document.getElementById("echarts-wordcloud")),e=t.chart_data;e=JSON.parse(e),e.toolbox.show=!1,o.setOption(e)})}function p(a){fetch("http://127.0.0.1:21314/message_counter",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wxid:s,time_range:a})}).then(t=>t.json()).then(t=>{var o=echarts.init(document.getElementById("echarts-sender")),i=t.chart_data_sender;i=JSON.parse(i),i.toolbox.show=!1,o.setOption(i);var e=echarts.init(document.getElementById("echarts-types")),i=t.chart_data_types;i=JSON.parse(i),i.toolbox.show=!1,e.setOption(i);var l=echarts.init(document.getElementById("echarts-weekday")),i=t.chart_data_weekday,i=JSON.parse(i);i.toolbox.show=!1,l.setOption(i)})}function y(a){fetch("http://127.0.0.1:21314/chatroom_mem_msg_count",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wxid:s,time_range:a})}).then(t=>t.json()).then(t=>{layui.use("table",function(){var o=layui.table;o.render({elem:"#members-msg-amount-table",cols:[[{field:"id",title:"ID",width:80},{field:"wxid",title:"wxid",minWidth:160},{field:"nickname",title:"群成员",width:120},{field:"class",title:"微信类别",width:120,sort:!0},{field:"msg_amount",title:"消息数量",minWidth:80,sort:!0}]],data:t,page:!0,limits:[5,10,15],limit:5})})})}function f(a){fetch("http://127.0.0.1:21314/contact_total_msg_amount",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wxid:s,time_range:a})}).then(t=>t.json()).then(t=>{var o=t;console.log("Contact:",o);var e=document.getElementById("total-msg-amount");e.innerText=o.total_msg_amount})}function _(a){fetch("http://127.0.0.1:21314/calendar",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wxid:s,time_range:a})}).then(t=>t.json()).then(t=>{var o=echarts.init(document.getElementById("echarts-calendar")),e=t.chart_data;e=JSON.parse(e),e.toolbox.show=!1,o.setOption(e)})}p(r);d(r);u(r);m(r);y(r);f(r);_(r);layui.define(["element","layer"],function(a){var n=jQuery=layui.jquery;layui.element;var t=layui.layer,o={chart2:function(e){n(this).offset().top,n(this).offset().left,t.open({title:"📝 图表数据展示",type:2,area:["800px","calc(100% - 50px)"],anim:2,resize:!0,closeBtn:1,shadeClose:!0,maxmin:!0,skin:"yourclass",content:"./chart.html?wxid="+s+"&type="+e})}};n(document).on("click","*[lay-event]",function(){var e=n(this).attr("lay-event"),l=n(this).attr("lay-data");typeof o[e]=="function"&&o[e].apply(this,[l])}),a("yadmin",o)});const g={wxid:s};fetch("http://127.0.0.1:21314/first_message",{method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify(g)}).then(a=>a.json()).then(a=>{var n=a;console.log("Contact:",n);var t=document.getElementById("first_time");t.innerText=n.first_time});fetch("http://127.0.0.1:21314/last_15_days_msg_amount",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(g)}).then(a=>a.json()).then(a=>{var n=echarts.init(document.getElementById("last-15-days")),t=a.chart_data;n.setOption(JSON.parse(t))});layui.use(["jquery"],function(){layui.jquery,window.addEventListener("message",function(a){var n=a.data;if(n.type==="setDate"){if(console.log("接收的日期为："+n.value),n.value){var t=n.value.split(" - ");c=t[0]+" 00:00:00",h=t[1]+" 23:59:59",r=[c,h]}else c="1998-01-01 00:00:00",h="2035-01-01 00:00:00",r=[c,h];console.log(r),p(r),d(r),u(r),m(r),y(r),f(r),_(r)}})});
