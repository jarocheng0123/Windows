import"./modulepreload-polyfill-B5Qt9EMX.js";import"./main-D83nNWqK.js";var c="1998-01-01 00:00:00",m="2035-01-01 00:00:00",r=[c,m];function v(){var n=window.parent.location.href,a=new URL(n),t=a.pathname,o=t.split("/"),e=o[o.length-1];return e}var s=v();function d(n){fetch("http://127.0.0.1:21314/month_count",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wxid:s,time_range:n})}).then(t=>t.json()).then(t=>{var o=echarts.init(document.getElementById("echarts-month_count")),e=t.chart_data;e=JSON.parse(e),e.toolbox.show=!1,o.setOption(e)})}function l(n){fetch("http://127.0.0.1:21314/hour_count",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wxid:s,time_range:n})}).then(t=>t.json()).then(t=>{var o=echarts.init(document.getElementById("echarts-hours")),e=t.chart_data;e=JSON.parse(e),e.toolbox.show=!1,o.setOption(e)})}function u(n){fetch("http://127.0.0.1:21314/wordcloud",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wxid:s,time_range:n})}).then(t=>t.json()).then(t=>{var o=echarts.init(document.getElementById("echarts-wordcloud")),e=t.chart_data;e=JSON.parse(e),e.toolbox.show=!1,o.setOption(e)})}function p(n){fetch("http://127.0.0.1:21314/message_counter",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wxid:s,time_range:n})}).then(t=>t.json()).then(t=>{var o=echarts.init(document.getElementById("echarts-sender")),i=t.chart_data_sender;i=JSON.parse(i),i.toolbox.show=!1,o.setOption(i);var e=echarts.init(document.getElementById("echarts-types")),i=t.chart_data_types;i=JSON.parse(i),i.toolbox.show=!1,e.setOption(i);var h=echarts.init(document.getElementById("echarts-weekday")),i=t.chart_data_weekday,i=JSON.parse(i);i.toolbox.show=!1,h.setOption(i)})}function y(n){fetch("http://127.0.0.1:21314/chatroom_mem_msg_count",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wxid:s,time_range:n})}).then(t=>t.json()).then(t=>{layui.use("table",function(){var o=layui.table;o.render({elem:"#members-msg-amount-table",cols:[[{field:"id",title:"ID",width:80},{field:"wxid",title:"wxid",minWidth:160},{field:"nickname",title:"群成员",width:120},{field:"class",title:"微信类别",width:120,sort:!0},{field:"msg_amount",title:"消息数量",minWidth:80,sort:!0}]],data:t,page:!0,limits:[5,10,15],limit:5})})})}function f(n){fetch("http://127.0.0.1:21314/contact_total_msg_amount",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wxid:s,time_range:n})}).then(t=>t.json()).then(t=>{var o=t;console.log("Contact:",o);var e=document.getElementById("total-msg-amount");e.innerText=o.total_msg_amount})}function g(n){fetch("http://127.0.0.1:21314/calendar",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wxid:s,time_range:n})}).then(t=>t.json()).then(t=>{var o=echarts.init(document.getElementById("echarts-calendar")),e=t.chart_data;e=JSON.parse(e),e.toolbox.show=!1,o.setOption(e)})}p(r);d(r);u(r);l(r);y(r);f(r);g(r);layui.define(["element","layer"],function(n){var a=jQuery=layui.jquery;layui.element;var t=layui.layer,o={chart2:function(e){t.open({title:"📝 图表数据展示",type:2,area:["800px","calc(100% - 100px)"],resize:!0,maxmin:!0,content:"./chart.html?wxid="+s+"&type="+e})}};a(document).on("click","*[lay-event]",function(){var e=a(this).attr("lay-event"),h=a(this).attr("lay-data");typeof o[e]=="function"&&o[e].apply(this,[h])}),a(function(){if(a("input[name=affordType]").first().val()==manFlag){var e=(a(top.window).height()-381)/2,h=parent.layer.getFrameIndex(window.name);parent.layer.style(h,{height:"381",top:e+"px"}),a("#manForm").show(),a("#comForm").hide(),currentForm=a("#manForm")}else a("#manForm").hide(),a("#comForm").show(),currentForm=a("#comForm")}),n("yadmin",o)});const _={wxid:s};fetch("http://127.0.0.1:21314/first_message",{method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify(_)}).then(n=>n.json()).then(n=>{var a=n;console.log("Contact:",a);var t=document.getElementById("first_time");t.innerText=a.first_time});fetch("http://127.0.0.1:21314/last_15_days_msg_amount",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(_)}).then(n=>n.json()).then(n=>{var a=echarts.init(document.getElementById("last-15-days")),t=n.chart_data;a.setOption(JSON.parse(t))});layui.use(["jquery"],function(){layui.jquery,window.addEventListener("message",function(n){var a=n.data;if(a.type==="setDate"){if(console.log("接收的日期为："+a.value),a.value){var t=a.value.split(" - ");c=t[0]+" 00:00:00",m=t[1]+" 23:59:59",r=[c,m]}else c="1998-01-01 00:00:00",m="2035-01-01 00:00:00",r=[c,m];console.log(r),p(r),d(r),u(r),l(r),y(r),f(r),g(r)}})});
