import"./modulepreload-polyfill-B5Qt9EMX.js";import"./main-D83nNWqK.js";var c="1998-01-01 00:00:00",h="2035-01-01 00:00:00",r=[c,h];function v(){var e=window.parent.location.href,n=new URL(e),t=n.pathname,o=t.split("/"),a=o[o.length-1];return a}var s=v();function l(e){fetch("http://127.0.0.1:21314/month_count",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wxid:s,time_range:e})}).then(t=>t.json()).then(t=>{var o=echarts.init(document.getElementById("echarts-month_count")),a=t.chart_data;a=JSON.parse(a),a.toolbox.show=!1,o.setOption(a)})}function m(e){fetch("http://127.0.0.1:21314/hour_count",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wxid:s,time_range:e})}).then(t=>t.json()).then(t=>{var o=echarts.init(document.getElementById("echarts-hours")),a=t.chart_data;a=JSON.parse(a),a.toolbox.show=!1,o.setOption(a)})}function u(e){fetch("http://127.0.0.1:21314/wordcloud",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wxid:s,time_range:e})}).then(t=>t.json()).then(t=>{var o=echarts.init(document.getElementById("echarts-wordcloud")),a=t.chart_data;a=JSON.parse(a),a.toolbox.show=!1,o.setOption(a)})}function p(e){fetch("http://127.0.0.1:21314/message_counter",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wxid:s,time_range:e})}).then(t=>t.json()).then(t=>{var o=echarts.init(document.getElementById("echarts-sender")),i=t.chart_data_sender;i=JSON.parse(i),i.toolbox.show=!1,o.setOption(i);var a=echarts.init(document.getElementById("echarts-types")),i=t.chart_data_types;i=JSON.parse(i),i.toolbox.show=!1,a.setOption(i);var d=echarts.init(document.getElementById("echarts-weekday")),i=t.chart_data_weekday,i=JSON.parse(i);i.toolbox.show=!1,d.setOption(i)})}function y(e){fetch("http://127.0.0.1:21314/chatroom_mem_msg_count",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wxid:s,time_range:e})}).then(t=>t.json()).then(t=>{layui.use("table",function(){var o=layui.table;o.render({elem:"#members-msg-amount-table",cols:[[{field:"id",title:"ID",width:80},{field:"wxid",title:"wxid",minWidth:160},{field:"nickname",title:"群成员",width:120},{field:"class",title:"微信类别",width:120,sort:!0},{field:"msg_amount",title:"消息数量",minWidth:80,sort:!0}]],data:t,page:!0,limits:[5,10,15],limit:5})})})}function f(e){fetch("http://127.0.0.1:21314/contact_total_msg_amount",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wxid:s,time_range:e})}).then(t=>t.json()).then(t=>{var o=t;console.log("Contact:",o);var a=document.getElementById("total-msg-amount");a.innerText=o.total_msg_amount})}function _(e){fetch("http://127.0.0.1:21314/calendar",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wxid:s,time_range:e})}).then(t=>t.json()).then(t=>{var o=echarts.init(document.getElementById("echarts-calendar")),a=t.chart_data;o.setOption(JSON.parse(a))})}p(r);l(r);u(r);m(r);y(r);f(r);_(r);layui.define(["element","layer"],function(e){var n=jQuery=layui.jquery;layui.element;var t=layui.layer,o={chart2:function(a){n(this).offset().top,n(this).offset().left,t.open({title:"📝 再见",type:2,area:["800px","calc(100% - 50px)"],anim:2,resize:!1,closeBtn:1,shadeClose:!0,maxmin:!0,skin:"yourclass",content:"./chart.html?wxid="+s+"&type="+a})}};n(document).on("click","*[lay-event]",function(){var a=n(this).attr("lay-event"),d=n(this).attr("lay-data");typeof o[a]=="function"&&o[a].apply(this,[d])}),e("yadmin",o)});const g={wxid:s};fetch("http://127.0.0.1:21314/first_message",{method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify(g)}).then(e=>e.json()).then(e=>{var n=e;console.log("Contact:",n);var t=document.getElementById("first_time");t.innerText=n.first_time});fetch("http://127.0.0.1:21314/last_15_days_msg_amount",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(g)}).then(e=>e.json()).then(e=>{var n=echarts.init(document.getElementById("last-15-days")),t=e.chart_data;n.setOption(JSON.parse(t))});layui.use(["jquery"],function(){layui.jquery,window.addEventListener("message",function(e){var n=e.data;if(n.type==="setDate"){if(console.log("接收的日期为："+n.value),n.value){var t=n.value.split(" - ");c=t[0]+" 00:00:00",h=t[1]+" 23:59:59",r=[c,h]}else c="1998-01-01 00:00:00",h="2035-01-01 00:00:00",r=[c,h];console.log(r),p(r),l(r),u(r),m(r),y(r),f(r),_(r)}})});
