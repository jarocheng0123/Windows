import"./modulepreload-polyfill-B5Qt9EMX.js";import"./main-D83nNWqK.js";var h="1998-01-01 00:00:00",d="2035-01-01 00:00:00",r=[h,d];function v(){var n=window.parent.location.href,e=new URL(n),t=e.pathname,o=t.split("/"),a=o[o.length-1];return a}var s=v();function m(n){fetch("http://127.0.0.1:21314/month_count",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wxid:s,time_range:n})}).then(t=>t.json()).then(t=>{var o=echarts.init(document.getElementById("echarts-month_count")),a=t.chart_data;a=JSON.parse(a),a.toolbox.show=!1,o.setOption(a)})}function l(n){fetch("http://127.0.0.1:21314/hour_count",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wxid:s,time_range:n})}).then(t=>t.json()).then(t=>{var o=echarts.init(document.getElementById("echarts-hours")),a=t.chart_data;a=JSON.parse(a),a.toolbox.show=!1,o.setOption(a)})}function u(n){fetch("http://127.0.0.1:21314/wordcloud",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wxid:s,time_range:n})}).then(t=>t.json()).then(t=>{var o=echarts.init(document.getElementById("echarts-wordcloud")),a=t.chart_data;a=JSON.parse(a),a.toolbox.show=!1,o.setOption(a)})}function p(n){fetch("http://127.0.0.1:21314/message_counter",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wxid:s,time_range:n})}).then(t=>t.json()).then(t=>{var o=echarts.init(document.getElementById("echarts-sender")),i=t.chart_data_sender;i=JSON.parse(i),i.toolbox.show=!1,o.setOption(i);var a=echarts.init(document.getElementById("echarts-types")),i=t.chart_data_types;i=JSON.parse(i),i.toolbox.show=!1,a.setOption(i);var c=echarts.init(document.getElementById("echarts-weekday")),i=t.chart_data_weekday,i=JSON.parse(i);i.toolbox.show=!1,c.setOption(i)})}function y(n){fetch("http://127.0.0.1:21314/chatroom_mem_msg_count",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wxid:s,time_range:n})}).then(t=>t.json()).then(t=>{layui.use("table",function(){var o=layui.table;o.render({elem:"#members-msg-amount-table",cols:[[{field:"id",title:"ID",width:80},{field:"wxid",title:"wxid",minWidth:160},{field:"nickname",title:"群成员",width:120},{field:"class",title:"微信类别",width:120,sort:!0},{field:"msg_amount",title:"消息数量",minWidth:80,sort:!0}]],data:t,page:!0,limits:[5,10,15],limit:5})})})}function f(n){fetch("http://127.0.0.1:21314/contact_total_msg_amount",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wxid:s,time_range:n})}).then(t=>t.json()).then(t=>{var o=t;console.log("Contact:",o);var a=document.getElementById("total-msg-amount");a.innerText=o.total_msg_amount})}function g(n){fetch("http://127.0.0.1:21314/calendar",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({wxid:s,time_range:n})}).then(t=>t.json()).then(t=>{var o=echarts.init(document.getElementById("echarts-calendar")),a=t.chart_data;a=JSON.parse(a),a.toolbox.show=!1,o.setOption(a)})}p(r);m(r);u(r);l(r);y(r);f(r);g(r);layui.define(["element","layer"],function(n){var e=jQuery=layui.jquery;layui.element;var t=layui.layer,o={chart2:function(a){t.open({title:"📝 图表数据展示",type:1,area:["400px","calc(100% - 50px)"],resize:!0,maxmin:!0,content:'<div style="padding: 20px;">这是一个可以调整大小的窗口</div>'})}};e(document).on("click","*[lay-event]",function(){var a=e(this).attr("lay-event"),c=e(this).attr("lay-data");typeof o[a]=="function"&&o[a].apply(this,[c])}),e(function(){if(e("input[name=affordType]").first().val()==manFlag){var a=(e(top.window).height()-381)/2,c=parent.layer.getFrameIndex(window.name);parent.layer.style(c,{height:"381",top:a+"px"}),e("#manForm").show(),e("#comForm").hide(),currentForm=e("#manForm")}else e("#manForm").hide(),e("#comForm").show(),currentForm=e("#comForm")}),n("yadmin",o)});const _={wxid:s};fetch("http://127.0.0.1:21314/first_message",{method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify(_)}).then(n=>n.json()).then(n=>{var e=n;console.log("Contact:",e);var t=document.getElementById("first_time");t.innerText=e.first_time});fetch("http://127.0.0.1:21314/last_15_days_msg_amount",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(_)}).then(n=>n.json()).then(n=>{var e=echarts.init(document.getElementById("last-15-days")),t=n.chart_data;e.setOption(JSON.parse(t))});layui.use(["jquery"],function(){layui.jquery,window.addEventListener("message",function(n){var e=n.data;if(e.type==="setDate"){if(console.log("接收的日期为："+e.value),e.value){var t=e.value.split(" - ");h=t[0]+" 00:00:00",d=t[1]+" 23:59:59",r=[h,d]}else h="1998-01-01 00:00:00",d="2035-01-01 00:00:00",r=[h,d];console.log(r),p(r),m(r),u(r),l(r),y(r),f(r),g(r)}})});
